<div class="kpi-cards">
    {% load humanize %}

    {% for campaign_type, data in campaigns_by_type.items %}
    
    <div class="kpi-row"> <!-- A row for each campaign type -->

        
        <!-- Clicks KPI Card -->
        <div class="kpi-card">
            <h3>
                 {% if campaign_type == "Stackadapt Display" %}
                Programmatic Display
            {% elif campaign_type == "Stackadapt Video" %}
                Programmatic Video
            {% else %}
                {{ campaign_type }}
            {% endif %} - Clicks
            </h3>
            <p class="measurement">{{ data.total_clicks|floatformat:0|intcomma }}
                {% if data.clicks_diffnum > 0 %}
                <span class="positive">(+{{ data.clicks_diffnum|floatformat:0|intcomma }})</span>
                {% else %}
                <span class="negative">({{ data.clicks_diffnum|floatformat:0|intcomma }})</span>
                {% endif %}
            </p>
            <p class="previous-percentage"> 
                {% if comparison_period == '7days' %}
                    vs. previous 7 days
                {% else %}
                    vs. previous month
                {% endif %}: 
                {% if data.previous_clicks > 0 %}
                    {% if data.clicks_diff > 0 %}
                        <span class="positive">+{{ data.clicks_diff|floatformat:2 }}%</span>
                    {% else %}
                        <span class="negative">{{ data.clicks_diff|floatformat:2 }}%</span>
                    {% endif %}
                {% else %}
                    No data for comparison.
                {% endif %}
            </p>
        </div>

        <!-- CTR KPI Card -->
        <div class="kpi-card">
            <h3>
                {% if campaign_type == "Stackadapt Display" %}
               Programmatic Display
           {% elif campaign_type == "Stackadapt Video" %}
               Programmatic Video
           {% else %}
               {{ campaign_type }}
           {% endif %} - CTR (%)
            </h3>
            <p class="measurement">{{ data.total_ctr|floatformat:2 }}%
                {% if data.ctr_diffnum > 0 %}
                <span class="positive">(+{{ data.ctr_diffnum|floatformat:2 }}%)</span>
                {% else %}
                <span class="negative">({{ data.ctr_diffnum|floatformat:2 }}%)</span>
                {% endif %}
            </p>
            <p class="previous-percentage"> 
                {% if comparison_period == '7days' %}
                    vs. previous 7 days
                {% else %}
                    vs. previous month
                {% endif %}: 
                {% if data.previous_ctr > 0 %}
                    {% if data.ctr_diff > 0 %}
                        <span class="positive">+{{ data.ctr_diff|floatformat:2 }}%</span>
                    {% else %}
                        <span class="negative">{{ data.ctr_diff|floatformat:2 }}%</span>
                    {% endif %}
                {% else %}
                    No data for comparison.
                {% endif %}
            </p>
        </div>

        <!-- CPC KPI Card -->
        <div class="kpi-card">
            <h3>
                {% if campaign_type == "Stackadapt Display" %}
               Programmatic Display
           {% elif campaign_type == "Stackadapt Video" %}
               Programmatic Video
           {% else %}
               {{ campaign_type }}
           {% endif %} - CPC
            </h3>
            <p class="measurement">£{{ data.total_cpc|floatformat:2 }}
                {% if data.cpc_diffnum > 0 %}
                <span class="negative">(+£{{ data.cpc_diffnum|floatformat:2 }})</span>
                {% else %}
                <span class="positive">(£{{ data.cpc_diffnum|floatformat:2 }})</span>
                {% endif %}
            </p>
            <p class="previous-percentage"> 
                {% if comparison_period == '7days' %}
                    vs. previous 7 days
                {% else %}
                    vs. previous month
                {% endif %}: 
                {% if data.previous_cpc > 0 %}
                    {% if data.cpc_diff > 0 %}
                        <span class="negative">+{{ data.cpc_diff|floatformat:2 }}%</span>
                    {% else %}
                        <span class="positive">{{ data.cpc_diff|floatformat:2 }}%</span>
                    {% endif %}
                {% else %}
                    No data for comparison.
                {% endif %}
            </p>
        </div>

    </div>
    {% endfor %}
</div>
